"use strict";(self.webpackChunkjohnycho_dev=self.webpackChunkjohnycho_dev||[]).push([[2481],{8732:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"spring-data-jpa/jpa-new-entity","title":"\uc0c8\ub85c\uc6b4 Entity \ud310\ub2e8 \uae30\uc900","description":"\u2714\ufe0f JPA\uc5d0\uc11c \uc0c8\ub85c\uc6b4 Entity\uc778\uc9c0 \ud310\ub2e8\ud558\ub294 \ubc29\ubc95\uc740 \ubb34\uc5c7\uc77c\uae4c?","source":"@site/docs/spring-data-jpa/jpa-new-entity.md","sourceDirName":"spring-data-jpa","slug":"/spring-data-jpa/jpa-new-entity","permalink":"/docs/spring-data-jpa/jpa-new-entity","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Spring","permalink":"/docs/tags/spring","description":"Spring Framework tag description"},{"inline":false,"label":"JPA","permalink":"/docs/tags/jpa","description":"JPA tag description"}],"version":"current","frontMatter":{"slug":"jpa-new-entity","title":"\uc0c8\ub85c\uc6b4 Entity \ud310\ub2e8 \uae30\uc900","tags":["spring","jpa"]},"sidebar":"johnyDocsSidebar","previous":{"title":"N + 1 \ubb38\uc81c","permalink":"/docs/spring-data-jpa/jpa-n+1-problem"},"next":{"title":"OneToOne \uc5f0\uad00\uad00\uacc4 Lazy Loading \ubb38\uc81c","permalink":"/docs/spring-data-jpa/jpa-one-to-one-lazy-loading"}}');var r=t(4848),s=t(8453);const a={slug:"jpa-new-entity",title:"\uc0c8\ub85c\uc6b4 Entity \ud310\ub2e8 \uae30\uc900",tags:["spring","jpa"]},l=void 0,o={},d=[{value:"\u2714\ufe0f JPA\uc5d0\uc11c \uc0c8\ub85c\uc6b4 Entity\uc778\uc9c0 \ud310\ub2e8\ud558\ub294 \ubc29\ubc95\uc740 \ubb34\uc5c7\uc77c\uae4c?",id:"\ufe0f-jpa\uc5d0\uc11c-\uc0c8\ub85c\uc6b4-entity\uc778\uc9c0-\ud310\ub2e8\ud558\ub294-\ubc29\ubc95\uc740-\ubb34\uc5c7\uc77c\uae4c",level:2},{value:"\u2714\ufe0f \uc9c1\uc811 ID\ub97c \ud560\ub2f9\ud558\ub294 \uacbd\uc6b0\uc5d0\ub294 \uc5b4\ub5bb\uac8c \ub3d9\uc791\ud560\uae4c? \ud83e\udd14",id:"\ufe0f-\uc9c1\uc811-id\ub97c-\ud560\ub2f9\ud558\ub294-\uacbd\uc6b0\uc5d0\ub294-\uc5b4\ub5bb\uac8c-\ub3d9\uc791\ud560\uae4c-",level:2},{value:"\u2714\ufe0f \uc0c8\ub85c\uc6b4 Entity\uc778\uc9c0 \ud310\ub2e8\ud558\ub294\uac8c \uc65c \uc911\uc694\ud560\uae4c? \ud83e\udd13",id:"\ufe0f-\uc0c8\ub85c\uc6b4-entity\uc778\uc9c0-\ud310\ub2e8\ud558\ub294\uac8c-\uc65c-\uc911\uc694\ud560\uae4c-",level:2}];function c(e){const n={code:"code",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"\ufe0f-jpa\uc5d0\uc11c-\uc0c8\ub85c\uc6b4-entity\uc778\uc9c0-\ud310\ub2e8\ud558\ub294-\ubc29\ubc95\uc740-\ubb34\uc5c7\uc77c\uae4c",children:"\u2714\ufe0f JPA\uc5d0\uc11c \uc0c8\ub85c\uc6b4 Entity\uc778\uc9c0 \ud310\ub2e8\ud558\ub294 \ubc29\ubc95\uc740 \ubb34\uc5c7\uc77c\uae4c?"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"@Override\npublic boolean isNew(T entity) {\n\n  if (versionAttribute.isEmpty()\n      || versionAttribute.map(Attribute::getJavaType).map(Class::isPrimitive).orElse(false)) {\n    return super.isNew(entity);\n  }\n\n  BeanWrapper wrapper = new DirectFieldAccessFallbackBeanWrapper(entity);\n\n  return versionAttribute.map(it -> wrapper.getPropertyValue(it.getName()) == null).orElse(true);\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\uc0c8\ub85c\uc6b4 Entity\uc778\uc9c0 \uc5ec\ubd80\ub294 ",(0,r.jsx)(n.code,{children:"JpaEntityInformation"}),"\uc758 ",(0,r.jsx)(n.code,{children:"isNew(T entity)"}),"\uc5d0 \uc758\ud574 \ud310\ub2e8\ub429\ub2c8\ub2e4. \ub2e4\ub978 \uc124\uc815\uc774 \uc5c6\uc73c\uba74\n",(0,r.jsx)(n.code,{children:"JpaEntityInformation"}),"\uc758\n\uad6c\ud604\uccb4 \uc911 ",(0,r.jsx)(n.code,{children:"JpaMetamodelEntityInformation"})," \ud074\ub798\uc2a4\uac00 \ub3d9\uc791\ud569\ub2c8\ub2e4. ",(0,r.jsx)(n.code,{children:"@Version"}),"\uc774 \uc0ac\uc6a9\ub41c \ud544\ub4dc\uac00 \uc5c6\uac70\ub098 ",(0,r.jsx)(n.code,{children:"@Version"}),"\uc774 \uc0ac\uc6a9\ub41c \ud544\ub4dc\uac00\nprimitive\n\ud0c0\uc785\uc774\uba74 ",(0,r.jsx)(n.code,{children:"AbstractEntityInformation"}),"\uc758 ",(0,r.jsx)(n.code,{children:"isNew()"}),"\ub97c \ud638\ucd9c\ud569\ub2c8\ub2e4. ",(0,r.jsx)(n.code,{children:"@Version"}),"\uc774 \uc0ac\uc6a9\ub41c \ud544\ub4dc\uac00 wrapper class\uc774\uba74 null\uc5ec\ubd80\ub97c\n\ud655\uc778\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'public boolean isNew(T entity) {\n\n  Id id = getId(entity);\n  Class<ID> idType = getIdType();\n\n  if (!idType.isPrimitive()) {\n    return id == null;\n  }\n\n  if (id instanceof Number) {\n    return ((Number) id).longValue() == 0L;\n  }\n\n  throw new IllegalArgumentException(String.format("Unsupported primitive id type %s", idType));\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"@Version"}),"\uc774 \uc0ac\uc6a9\ub41c \ud544\ub4dc\uac00 \uc5c6\uc5b4\uc11c AbstractEntityInformation \ud074\ub798\uc2a4\uac00 \ub3d9\uc791\ud558\uba74 ",(0,r.jsx)(n.code,{children:"@Id"})," \uc5b4\ub178\ud14c\uc774\uc158\uc744 \uc0ac\uc6a9\ud55c \ud544\ub4dc\ub97c \ud655\uc778\ud574\uc11c primitive \ud0c0\uc785\uc774\n\uc544\ub2c8\ub77c\uba74\nnull \uc5ec\ubd80, ",(0,r.jsx)(n.code,{children:"Number"}),"\uc758 \ud558\uc704 \ud0c0\uc785\uc774\uba74 0\uc778\uc9c0 \uc5ec\ubd80\ub97c \ud655\uc778\ud569\ub2c8\ub2e4. ",(0,r.jsx)(n.code,{children:"@GeneratedValue"})," \uc5b4\ub178\ud14c\uc774\uc158\uc73c\ub85c \ud0a4 \uc0dd\uc131 \uc804\ub7b5\uc744 \uc0ac\uc6a9\ud558\uba74 \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc800\uc7a5\ub420 \ub54c id\uac00\n\ud560\ub2f9\ub429\ub2c8\ub2e4. \ub530\ub77c\uc11c \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc800\uc7a5\ub418\uae30 \uc804\uc5d0 \uba54\ubaa8\ub9ac\uc5d0\uc11c \uc0dd\uc131\ub41c \uac1d\uccb4\ub294 id\uac00 \ube44\uc5b4\uc788\uae30 \ub54c\ubb38\uc5d0 ",(0,r.jsx)(n.code,{children:"isNew()"}),"\ub294 true\uac00 \ub418\uc5b4 \uc0c8\ub85c\uc6b4 entity\ub85c \ud310\ub2e8\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-\uc9c1\uc811-id\ub97c-\ud560\ub2f9\ud558\ub294-\uacbd\uc6b0\uc5d0\ub294-\uc5b4\ub5bb\uac8c-\ub3d9\uc791\ud560\uae4c-",children:"\u2714\ufe0f \uc9c1\uc811 ID\ub97c \ud560\ub2f9\ud558\ub294 \uacbd\uc6b0\uc5d0\ub294 \uc5b4\ub5bb\uac8c \ub3d9\uc791\ud560\uae4c? \ud83e\udd14"}),"\n",(0,r.jsxs)(n.p,{children:["\ud0a4 \uc0dd\uc131 \uc804\ub7b5\uc744 \uc0ac\uc6a9\ud558\uc9c0 \uc54a\uace0 \uc9c1\uc811 ID\ub97c \ud560\ub2f9\ud558\ub294 \uacbd\uc6b0 \uc0c8\ub85c\uc6b4 entity\ub85c \uac04\uc8fc\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \uc774 \ub54c\ub294 ",(0,r.jsx)("mark",{children:(0,r.jsxs)(n.strong,{children:["\uc5d4\ud2f0\ud2f0\uc5d0\uc11c ",(0,r.jsx)(n.code,{children:"Persistable<T>"})," \uc778\ud130\ud398\uc774\uc2a4\ub97c \uad6c\ud604"]})}),"\ud574\uc11c\n",(0,r.jsx)(n.code,{children:"JpaMetamodelEntityInformation"})," \ud074\ub798\uc2a4\uac00 \uc544\ub2cc ",(0,r.jsx)(n.code,{children:"JpaPersistableEntityInformation"}),"\uc758 ",(0,r.jsx)(n.code,{children:"isNew()"}),"\uac00 \ub3d9\uc791\ud558\ub3c4\ub85d \ud574\uc57c \ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class JpaPersistableEntityInformation<T extends Persistable<ID>, ID>\n    extends JpaMetamodelEntityInformation<T, ID> {\n\n  public JpaPersistableEntityInformation(Class<T> domainClass, Metamodel metamodel,\n      PersistenceUnitUtil persistenceUnitUtil) {\n    super(domainClass, metamodel, persistenceUnitUtil);\n  }\n\n  @Override\n  public boolean isNew(T entity) {\n    return entity.isNew();\n  }\n\n  @Nullable\n  @Override\n  public ID getId(T entity) {\n    return entity.getId();\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-\uc0c8\ub85c\uc6b4-entity\uc778\uc9c0-\ud310\ub2e8\ud558\ub294\uac8c-\uc65c-\uc911\uc694\ud560\uae4c-",children:"\u2714\ufe0f \uc0c8\ub85c\uc6b4 Entity\uc778\uc9c0 \ud310\ub2e8\ud558\ub294\uac8c \uc65c \uc911\uc694\ud560\uae4c? \ud83e\udd13"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'\n@Override\n@Transactional\npublic <S extends T> S save(S entity) {\n\n  Assert.notNull(entity, "Entity must not be null");\n\n  if (entityInformation.isNew(entity)) {\n    entityManager.persist(entity);\n    return entity;\n  } else {\n    return entityManager.merge(entity);\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"SimpleJpaRepository"}),"\uc758 ",(0,r.jsx)(n.code,{children:"save()"})," \uba54\uc11c\ub4dc\uc5d0\uc11c ",(0,r.jsx)(n.code,{children:"isNew()"}),"\ub97c \uc0ac\uc6a9\ud558\uc5ec ",(0,r.jsx)(n.code,{children:"persist"}),"\ub97c \uc218\ud589\ud560\uc9c0 ",(0,r.jsx)(n.code,{children:"merge"}),"\ub97c \uc218\ud589\ud560\uc9c0 \uacb0\uc815\ud569\ub2c8\ub2e4. \ub9cc\uc57d ID\ub97c \uc9c1\uc811\n\uc9c0\uc815\ud574\uc8fc\ub294\n\uacbd\uc6b0\uc5d0\ub294 \uc2e0\uaddc entity\ub77c\uace0 \ud310\ub2e8\ud558\uc9c0 \uc54a\uae30 \ub54c\ubb38\uc5d0 ",(0,r.jsx)(n.code,{children:"merge"}),"\ub97c \uc218\ud589\ud569\ub2c8\ub2e4. \uc774\ub54c ",(0,r.jsx)("mark",{children:(0,r.jsx)(n.strong,{children:"\ud574\ub2f9 entity\ub294 \uc2e0\uaddc\uc784\uc5d0\ub3c4 \ubd88\uad6c\ud558\uace0 DB\ub97c \uc870\ud68c\ud558\uae30 \ub54c\ubb38\uc5d0 \ube44\ud6a8\uc728\uc801"})}),"\uc785\ub2c8\ub2e4. \ub530\ub77c\uc11c, \uc0c8\ub85c\uc6b4\nentity\uc778\uc9c0 \ud310\ub2e8\ud558\ub294 \uac83\uc740 \uc911\uc694\ud55c \ubd80\ubd84\uc785\ub2c8\ub2e4."]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>l});var i=t(6540);const r={},s=i.createContext(r);function a(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);