"use strict";(self.webpackChunkjohnycho_dev=self.webpackChunkjohnycho_dev||[]).push([[101],{7114:(n,e,d)=>{d.r(e),d.d(e,{assets:()=>i,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"db/db-mysql-innodb-lock","title":"MySQL InnoDB\uc758 \uac2d \ub77d\uacfc \ub125\uc2a4\ud2b8\ud0a4 \ub77d","description":"\u2714\ufe0f Phantom Read\ub780?","source":"@site/docs/db/db-mysql-innodb-lock.md","sourceDirName":"db","slug":"/db/db-mysql-innodb-lock","permalink":"/docs/db/db-mysql-innodb-lock","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Database","permalink":"/docs/tags/db","description":"Database tag description"},{"inline":false,"label":"MySQL","permalink":"/docs/tags/mysql","description":"MySQL tag description"}],"version":"current","frontMatter":{"slug":"db-mysql-innodb-lock","title":"MySQL InnoDB\uc758 \uac2d \ub77d\uacfc \ub125\uc2a4\ud2b8\ud0a4 \ub77d","tags":["db","mysql"]},"sidebar":"johnyDocsSidebar","previous":{"title":"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc778\ub371\uc2a4","permalink":"/docs/db/db-index"},"next":{"title":"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc815\uaddc\ud654","permalink":"/docs/db/db-normalization"}}');var r=d(4848),t=d(8453);const o={slug:"db-mysql-innodb-lock",title:"MySQL InnoDB\uc758 \uac2d \ub77d\uacfc \ub125\uc2a4\ud2b8\ud0a4 \ub77d",tags:["db","mysql"]},l="MySQL InnoDB\uc5d0\uc11c \uac2d\ub77d\uacfc \ub125\uc2a4\ud2b8\ud0a4 \ub77d\uc774\ub780 \ubb34\uc5c7\uc774\uba70, \uc5b4\ub5bb\uac8c \ud32c\ud140 \ub9ac\ub4dc\ub97c \ubc29\uc9c0\ud560\uae4c?",i={},c=[{value:"\u2714\ufe0f Phantom Read\ub780?",id:"\ufe0f-phantom-read\ub780",level:2},{value:"\u2714\ufe0f \uac2d \ub77d(Gap Lock)\uc774\ub780?",id:"\ufe0f-\uac2d-\ub77dgap-lock\uc774\ub780",level:2},{value:"\u2714\ufe0f \ub125\uc2a4\ud2b8\ud0a4 \ub77d(Next-Key Lock)\uc774\ub780?",id:"\ufe0f-\ub125\uc2a4\ud2b8\ud0a4-\ub77dnext-key-lock\uc774\ub780",level:2},{value:"\u2714\ufe0f \uac2d \ub77d\uacfc \ub125\uc2a4\ud2b8\ud0a4 \ub77d\uc744 \ud1b5\ud55c \ud32c\ud140 \ub9ac\ub4dc \ubc29\uc9c0 \uba54\ucee4\ub2c8\uc998",id:"\ufe0f-\uac2d-\ub77d\uacfc-\ub125\uc2a4\ud2b8\ud0a4-\ub77d\uc744-\ud1b5\ud55c-\ud32c\ud140-\ub9ac\ub4dc-\ubc29\uc9c0-\uba54\ucee4\ub2c8\uc998",level:2}];function a(n){const e={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"mysql-innodb\uc5d0\uc11c-\uac2d\ub77d\uacfc-\ub125\uc2a4\ud2b8\ud0a4-\ub77d\uc774\ub780-\ubb34\uc5c7\uc774\uba70-\uc5b4\ub5bb\uac8c-\ud32c\ud140-\ub9ac\ub4dc\ub97c-\ubc29\uc9c0\ud560\uae4c",children:"MySQL InnoDB\uc5d0\uc11c \uac2d\ub77d\uacfc \ub125\uc2a4\ud2b8\ud0a4 \ub77d\uc774\ub780 \ubb34\uc5c7\uc774\uba70, \uc5b4\ub5bb\uac8c \ud32c\ud140 \ub9ac\ub4dc\ub97c \ubc29\uc9c0\ud560\uae4c?"})}),"\n",(0,r.jsx)(e.h2,{id:"\ufe0f-phantom-read\ub780",children:"\u2714\ufe0f Phantom Read\ub780?"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"Phantom Read"}),"\ub294 \ud2b8\ub79c\uc7ad\uc158\uc774 \ub3d9\uc77c\ud55c \uc870\uac74\uc758 \ucffc\ub9ac\ub97c \ubc18\ubcf5 \uc2e4\ud589\ud560 \ub54c, \ub098\uc911\uc5d0 \uc2e4\ud589\ub41c \ucffc\ub9ac\uc5d0\uc11c \ucc98\uc74c\uc5d0\ub294 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc558\ub358 \uc0c8\ub85c\uc6b4 \ud589\uc774 \ub098\ud0c0\ub098\ub294 \ud604\uc0c1\uc744 \ub9d0\ud569\ub2c8\ub2e4. \uc774\ub294 \uc8fc\ub85c ",(0,r.jsx)(e.strong,{children:"\uc77d\uae30 \uc77c\uad00\uc131(Read Consistency)"})," \uc744 \uc720\uc9c0\ud558\ub294 \uacfc\uc815\uc5d0\uc11c \ubc1c\uc0dd\ud560 \uc218 \uc788\ub294 \ubb38\uc81c\ub85c, \ub370\uc774\ud130\uc758 \uc0bd\uc785\uc774\ub098 \uc0ad\uc81c\uac00 \ub2e4\ub978 \ud2b8\ub79c\uc7ad\uc158\uc5d0 \uc758\ud574 \uc774\ub8e8\uc5b4\uc9c8 \ub54c \ubc1c\uc0dd\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \ud2b8\ub79c\uc7ad\uc158 A \uc2dc\uc791\nSTART TRANSACTION;\n\n-- \ud2b8\ub79c\uc7ad\uc158 A \uccab \ubc88\uc9f8 \uc870\ud68c\nSELECT * FROM orders WHERE amount > 150;\n\n-- \ud2b8\ub79c\uc7ad\uc158 B \uc2dc\uc791\nSTART TRANSACTION;\n\n-- \ud2b8\ub79c\uc7ad\uc158 B \uc0c8\ub85c\uc6b4 \ud589 \uc0bd\uc785\nINSERT INTO orders (customer_id, amount) VALUES (4, 250);\n\n-- \ud2b8\ub79c\uc7ad\uc158 B \ucee4\ubc0b\nCOMMIT;\n\n-- \ub3d9\uc77c\ud55c \uc870\uac74\uc73c\ub85c \ud2b8\ub79c\uc7ad\uc158 A \ub450 \ubc88\uc9f8 \uc870\ud68c\uc2dc, \ud2b8\ub79c\uc7ad\uc158 A\uc758 \uccab \ubc88\uc9f8 \uc870\ud68c\uc5d0\ub294 \uc874\uc7ac\ud558\uc9c0 \uc54a\ub358, \ud2b8\ub79c\uc7ad\uc158 B\uc5d0\uc11c \uc0bd\uc785\ub41c \uc0c8\ub85c\uc6b4 \ud589\uc774 \ud568\uaed8 \uc870\ud68c\ub41c\ub2e4.\n-- \ub2e8, MVCC\ub97c \uc9c0\uc6d0\ud558\ub294 \uacbd\uc6b0 \ud574\ub2f9 \ucf00\uc774\uc2a4\uc5d0\uc11c \ud32c\ud140 \ub9ac\ub4dc\uac00 \ubc1c\uc0dd\ud558\uc9c0 \uc54a\ub294\ub2e4.\nSELECT * FROM orders WHERE amount > 150;\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\ufe0f-\uac2d-\ub77dgap-lock\uc774\ub780",children:"\u2714\ufe0f \uac2d \ub77d(Gap Lock)\uc774\ub780?"}),"\n",(0,r.jsxs)(e.p,{children:["\uac2d \ub77d\uc740 \ud2b9\uc815 \uc778\ub371\uc2a4 \uac12 \uc0ac\uc774\uc758 \uacf5\uac04\uc744 \uc7a0\uadf8\ub294 \ub77d\uc785\ub2c8\ub2e4. \uae30\uc874 \ub808\ucf54\ub4dc \uac04\uc758 \uac04\uaca9\uc744 \ubcf4\ud638\ud558\uc5ec \uc0c8\ub85c\uc6b4 \ub808\ucf54\ub4dc\uc758 \uc0bd\uc785\uc744 \ubc29\uc9c0\ud569\ub2c8\ub2e4. ",(0,r.jsx)("mark",{children:(0,r.jsx)(e.strong,{children:"\uac2d \ub77d\uc740 \ubc94\uc704 \ub0b4\uc5d0 \ud2b9\uc815 \ub808\ucf54\ub4dc\uac00 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc744 \ub54c \uc801\uc6a9"})}),"\ub429\ub2c8\ub2e4. \ud2b8\ub79c\uc7ad\uc158\uc774 ",(0,r.jsx)("mark",{children:(0,r.jsx)(e.strong,{children:"\ud2b9\uc815 \ubc94\uc704 \ub0b4\uc5d0\uc11c \ub370\uc774\ud130\uc758 \uc0bd\uc785\uc744 \ub9c9\uc544 \ud32c\ud140 \uc77d\uae30(Phantom Read) \ud604\uc0c1\uc744 \ubc29\uc9c0"})}),"\ud569\ub2c8\ub2e4. \uc608\ub97c \ub4e4\uc5b4, \uc778\ub371\uc2a4 \uac12 10\uacfc 20 \uc0ac\uc774\uc758 \uac2d\uc744 \uc7a0\uadf8\uba74 \uc774 \ubc94\uc704 \ub0b4\uc5d0 \uc0c8\ub85c\uc6b4 \ub808\ucf54\ub4dc 15\ub97c \ucd94\uac00\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- id 1, 3, 5\uac00 \uc800\uc7a5\ub41c orders \ud14c\uc774\ube14\n\n-- \ud2b8\ub79c\uc7ad\uc158 A \uc2dc\uc791\nSTART TRANSACTION;\n\n-- \ud2b8\ub79c\uc7ad\uc158 A 1-3\uacfc 3-5 \uc0ac\uc774\uc758 \uac2d\uacfc 3 \ub808\ucf54\ub4dc \ub77d \uc124\uc815(\ub125\uc2a4\ud2b8\ud0a4 \ub77d)\nSELECT * FROM orders WHERE orders_id BETWEEN 2 AND 4 FOR UPDATE;\n\n-- \ud2b8\ub79c\uc7ad\uc158 B \uc2dc\uc791\nSTART TRANSACTION;\n\n-- \ud2b8\ub79c\uc7ad\uc158 B\uac00 id 4\uc5d0 \ub370\uc774\ud130 \uc0bd\uc785 \uc2dc\ub3c4 \uc2dc, \uac2d\ub77d\uc73c\ub85c \uc778\ud574 \uc0bd\uc785\uc774 \ucc28\ub2e8\ub418\uc5b4 \ub300\uae30\nINSERT INTO orders (orders_id, orders_amount) VALUES (4, 200);\n...\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\ufe0f-\ub125\uc2a4\ud2b8\ud0a4-\ub77dnext-key-lock\uc774\ub780",children:"\u2714\ufe0f \ub125\uc2a4\ud2b8\ud0a4 \ub77d(Next-Key Lock)\uc774\ub780?"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\ub125\uc2a4\ud2b8\ud0a4 \ub77d"}),"\uc740 ",(0,r.jsx)(e.strong,{children:"\ub808\ucf54\ub4dc \ub77d"}),"\uacfc ",(0,r.jsx)(e.strong,{children:"\uac2d \ub77d"}),"\uc744 \uacb0\ud569\ud55c \ud615\ud0dc\ub85c, \ud2b9\uc815 \uc778\ub371\uc2a4 \ub808\ucf54\ub4dc\uc640 \uadf8 \uc8fc\ubcc0\uc758 \uac2d\uc744 \ub3d9\uc2dc\uc5d0 \uc7a0\uadf8\ub294 \ub77d\uc785\ub2c8\ub2e4. \uc774\ub97c \ud1b5\ud574 \ub808\ucf54\ub4dc \uc790\uccb4\uc758 \ubcc0\uacbd\uacfc \ud568\uaed8 \uadf8 \uc8fc\ubcc0 \uacf5\uac04\uc758 \ubcc0\uacbd\ub3c4 \ub3d9\uc2dc\uc5d0 \uc81c\uc5b4\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\ub125\uc2a4\ud2b8\ud0a4 \ub77d"}),"\uc740 \ud2b9\uc815 \ub808\ucf54\ub4dc\uc640 \uadf8 \uc8fc\ubcc0 \uacf5\uac04\uc744 \uc7a0\uadf8\uae30 \ub54c\ubb38\uc5d0, \ub2e4\ub978 \ud2b8\ub79c\uc7ad\uc158\uc774 \uc0c8\ub85c\uc6b4 \ub808\ucf54\ub4dc\ub97c \uc0bd\uc785\ud558\uc5ec \ud32c\ud140 \ub9ac\ub4dc\ub97c \ubc1c\uc0dd\uc2dc\ud0a4\ub294 \uac83\uc744 \ubc29\uc9c0\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"orders_id"}),(0,r.jsx)(e.th,{children:"orders_amount"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"1"}),(0,r.jsx)(e.td,{children:"100"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"2"}),(0,r.jsx)(e.td,{children:"200"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"3"}),(0,r.jsx)(e.td,{children:"300"})]})]})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \ud2b8\ub79c\uc7ad\uc158 A \uc2dc\uc791\nSTART TRANSACTION;\n\n-- \ud2b8\ub79c\uc7ad\uc158 A amount = 200\uc778 orders_id = 2 \ub808\ucf54\ub4dc\uc5d0 \ub300\ud55c \ub808\ucf54\ub4dc \ub77d\uacfc 1-2, 2-3\uc5d0 \ub300\ud55c \uac2d\ub77d\uc744 \ub3d9\uc2dc\uc5d0 \uc7a0\uae08\uc73c\ub85c\uc368 \ub125\uc2a4\ud2b8\ud0a4 \ub77d\uc744 \uc124\uc815\nSELECT * FROM orders WHERE orders_amount = 200 FOR UPDATE;\n\n-- \ud2b8\ub79c\uc7ad\uc158 B \uc2dc\uc791\nSTART TRANSACTION;\n\n-- \ud2b8\ub79c\uc7ad\uc158 B orders_id = 4, orders_amount = 200\uc778 \ub808\ucf54\ub4dc \uc0bd\uc785 \uc2dc\ub3c4 \uc2dc, \ub125\uc2a4\ud2b8\ud0a4 \ub77d\uc73c\ub85c \uc778\ud574 \ucc28\ub2e8\ub418\uc5b4 \ub300\uae30\nINSERT INTO orders (orders_id, order_amount) VALUES (4, 200);\n...\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\ufe0f-\uac2d-\ub77d\uacfc-\ub125\uc2a4\ud2b8\ud0a4-\ub77d\uc744-\ud1b5\ud55c-\ud32c\ud140-\ub9ac\ub4dc-\ubc29\uc9c0-\uba54\ucee4\ub2c8\uc998",children:"\u2714\ufe0f \uac2d \ub77d\uacfc \ub125\uc2a4\ud2b8\ud0a4 \ub77d\uc744 \ud1b5\ud55c \ud32c\ud140 \ub9ac\ub4dc \ubc29\uc9c0 \uba54\ucee4\ub2c8\uc998"}),"\n",(0,r.jsx)(e.p,{children:"\ud2b8\ub79c\uc7ad\uc158 A\uac00 \ud2b9\uc815 \ubc94\uc704\uc758 \ub370\uc774\ud130\ub97c \uc870\ud68c\ud560 \ub54c, \ud574\ub2f9 \ubc94\uc704\uc5d0 \ub300\ud574 \uac2d\ub77d \ub610\ub294 \ub125\uc2a4\ud2b8\ud0a4 \ub77d\uc744 \uc124\uc815\ud569\ub2c8\ub2e4. \ub77d\uc774 \uc124\uc815\ub41c \ubc94\uc704 \ub0b4\uc5d0\uc11c\ub294 \ud2b8\ub79c\uc7ad\uc158 B\uac00 \uc0c8\ub85c\uc6b4 \ub808\ucf54\ub4dc\ub97c \uc0bd\uc785\ud558\uac70\ub098 \uae30\uc874 \ub808\ucf54\ub4dc\ub97c \uc218\uc815\ud558\ub294 \uac83\uc774 \ucc28\ub2e8\ub429\ub2c8\ub2e4. \ub530\ub77c\uc11c, \ud2b8\ub79c\uc7ad\uc158 A\uac00 \ub2e4\uc2dc \ub3d9\uc77c\ud55c \uc870\uac74\uc73c\ub85c \uc870\ud68c\ub97c \uc218\ud589\ud558\ub354\ub77c\ub3c4, \ud2b8\ub79c\uc7ad\uc158 B\uc5d0 \uc758\ud574 \uc0c8\ub85c\uc6b4 \ub370\uc774\ud130\uac00 \uc0bd\uc785\ub418\uc9c0 \uc54a\uc544 \ud32c\ud140 \ub9ac\ub4dc\uac00 \ubc1c\uc0dd\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."})]})}function h(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(a,{...n})}):a(n)}},8453:(n,e,d)=>{d.d(e,{R:()=>o,x:()=>l});var s=d(6540);const r={},t=s.createContext(r);function o(n){const e=s.useContext(t);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:o(n.components),s.createElement(t.Provider,{value:e},n.children)}}}]);