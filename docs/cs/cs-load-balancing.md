---
slug: cs-load-balancing
title: λ΅λ“ λ°Έλ°μ‹±
tags: [ cs, network ]
---

λ΅λ“ λ°Έλ°μ‹±μ΄λ€ <mark>**μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ§€μ›ν•λ” λ¦¬μ†μ¤ ν’€μ— λ“¤μ–΄μ¤λ” λ„¤νΈμ›ν¬ νΈλν”½(λ“¤μ–΄μ¤λ” μ”μ²­)μ„ κ· λ“±ν•κ² λ¶„μ‚°ν•λ” κ²ƒ**</mark>μ„ μλ―Έν•©λ‹λ‹¤. μ΄λ¥Ό μν–‰ν•λ” λ΅λ“ λ°Έλ°μ„λ” μ• ν”λ¦¬μΌ€μ΄μ… μ„λ²„ μ•λ‹¨μ— μ„μΉν•λ©° ν΄λΌμ΄μ–ΈνΈ μ”μ²­μ„ μ§€μ‹ν•κ³  μ μ–΄ν•©λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄μ„ μ• ν”λ¦¬μΌ€μ΄μ…μ κ°€μ©μ„±, ν™•μ¥μ„±, λ³΄μ• λ° μ„±λ¥μ„ ν™•λ³΄ν•  μ μμµλ‹λ‹¤.

## β”οΈ λ΅λ“ λ°Έλ°μ‹± κΈ°λ²•(μ•κ³ λ¦¬μ¦)

### π“ λΌμ΄λ“ λ΅λΉ(Round Robin)
λ¨λ“  μ”μ²­μ΄ μμ„λ€λ΅ μ²λ¦¬λλ” λ°©μ‹μ…λ‹λ‹¤. μ„λ²„κ°€ 3λ€(A, B, C)κ°€ μ΅΄μ¬ν•λ©΄ μ”μ²­μ€ ABCABC μμ„λ€λ΅ μ „λ‹¬λ©λ‹λ‹¤. λ¨λ“  μ„λ²„μ μ²λ¦¬ λ¥λ ¥μ΄ λ™λ“±ν•κ³ , μ”μ²­μ κ³ λ¥Έ λ¶„μ‚°μ΄ μ¤‘μ”ν• κ²½μ° κ³ λ ¤ν•΄λ³Ό μ μμµλ‹λ‹¤. κµ¬ν„μ΄ μ‰¬μ°λ©° κ³ λ¥Έ λ¶„μ‚°μ„ λ³΄μ¥ν•λ‹¤λ” κ²ƒμ΄ μ¥μ μ…λ‹λ‹¤. ν•μ§€λ§, μ„λ²„ λ¶€ν•λ‚ μ‘λ‹µ μ‹κ°„μ„ κ³ λ ¤ν•μ§€ μ•κ³  μ„λ²„μ μ²λ¦¬ λ¥λ ¥μ΄ λ‹¤λ¥Έ κ²½μ° λΉ„ν¨μ¨μ μ΄λΌλ” κ²ƒμ΄ λ‹¨μ μ…λ‹λ‹¤.

### π“ κ°€μ¤‘μΉ λΌμ΄λ“ λ΅λΉ(Weighted Round Robin)
λΌμ΄λ“ λ΅λΉ λ°©μ‹μ— κ°€μ¤‘μΉλΌλ” κ°λ…μ„ μ¶”κ°€ν•©λ‹λ‹¤. κ° μ„λ²„λ” μ²λ¦¬ λ¥λ ¥κ³Ό κ°€μ© μμ›μ— λ”°λΌμ„ κ°€μ¤‘μΉλ¥Ό ν• λ‹Ή λ°›κ² λ©λ‹λ‹¤. κ·Έλ¦¬κ³ , λΌμ΄λ“ λ΅λΉ λ°©μ‹μ„ μ‚¬μ©ν•λ κ°€μ¤‘μΉκ°€ λ†’μ€ μ„λ²„λ” κ°€μ¤‘μΉμ— λΉ„λ΅€ν•μ—¬ μƒλ€μ μΌλ΅ λ”μ± λ§μ€ μ”μ²­μ„ λ°›κ² λ©λ‹λ‹¤.

![Weighted Round Robin](img/weighted-round-robin.png)
λΌμ΄λ“ λ΅λΉλ³΄λ‹¤ μƒλ€μ μΌλ΅ κµ¬ν„μ΄ λ³µμ΅ν•μ§€λ§ κ° μ„λ²„μ μ²λ¦¬ λ¥λ ¥μ„ κ³ λ ¤ν•μ§€ μ•λ”λ‹¤λ” λΌμ΄λ“ λ΅λΉ λ°©μ‹μ λ‹¨μ μ„ κ°μ„ ν•©λ‹λ‹¤. ν•μ§€λ§, μ—¬μ „ν <mark>**μ„λ²„μ μƒνƒλ¥Ό κ³ λ ¤ν•μ§€ μ•λ” λ°©μ‹**</mark>μ΄λΌλ” μ μ„ μ μν•΄μ•Όν•©λ‹λ‹¤.

### π“ μµμ† μ—°κ²°(Least Connections)
κ° μ„λ²„μ ν™μ„± μ—°κ²° μλ¥Ό λ¨λ‹ν„°λ§ν•κ³  μλ” κ²½μ°μ— μ‚¬μ©ν•  μ μμµλ‹λ‹¤. <mark>**κ°€μ¥ μ μ€ ν™μ„± μ—°κ²°μ΄ μ΅΄μ¬ν•λ” μ„λ²„μ—κ² μ”μ²­μ„ μ „λ‹¬ν•λ” λ°©μ‹**</mark>μ…λ‹λ‹¤. κ° μ„λ²„μ μ²λ¦¬ λ¥λ ¥μ΄ λ‹¤λ¥Έ κ²½μ°μ—λ” μ ν•©ν•μ§€ μ•μ„ μ μμµλ‹λ‹¤. μ²λ¦¬ λ¥λ ¥μ΄ ν° μ„λ²„λ” μƒλ€μ μΌλ΅ ν™μ„± μ—°κ²°μ„ λ”μ± λ§μ΄ μλ¦½ν•  μ μκΈ° λ•λ¬Έμ…λ‹λ‹¤. μµμ† μ—°κ²° λ°©μ‹μ€ κ° μ„λ²„μ μ²λ¦¬ λ¥λ ¥μ΄ λΉ„μ·ν•μ§€λ§ νΉμ • μ΄μ λ΅ ν• μ„λ²„μ— λ™μ‹ μ—°κ²° μκ°€ λ§μ•„ μ§€λ” μƒν™©μ΄ μ΅΄μ¬ν•λ” κ²½μ° κ³ λ ¤ν•΄λ³Ό μ μμµλ‹λ‹¤.

### π“ κ°€μ¤‘μΉ μµμ† μ—°κ²°(Weighted Least Connections)
λ΅λ“ λ°Έλ°μ‹± λ€μƒμ— μƒλ€μ μΌλ΅ μ²λ¦¬ λ¥λ ¥μ΄ ν° μ„λ²„κ°€ μ΅΄μ¬ν•λ” κ²½μ°μ—λ” λΌμ΄λ“ λ΅λΉκ³Ό λ§μ°¬κ°€μ§€λ΅ κ°€μ¤‘μΉλΌλ” κ°λ…μ„ μ‚¬μ©ν•΄λ³Ό μ μμµλ‹λ‹¤.

μ΄ λ°©μ‹μ€ λ‘ κ°€μ§€ μ£Όμ” μ”μ†λ¥Ό κ³ λ ¤ν•μ—¬ λ™μ‘ν•©λ‹λ‹¤.
- μ—°κ²° μ(Connections)
- ν„μ¬ κ° μ„λ²„μ— μ—°κ²°λ ν΄λΌμ΄μ–ΈνΈμ μμ…λ‹λ‹¤.
- κ°€μ¤‘μΉ(Weight)
- κ° μ„λ²„κ°€ κ°€μ§„ μ²λ¦¬ λ¥λ ¥μ΄λ‚ μ„±λ¥μ„ λ‚νƒ€λ‚΄λ” κ°’μ…λ‹λ‹¤.
- μ²λ¦¬ λ¥λ ¥μ΄ λ›°μ–΄λ‚ μ„λ²„μ— λ†’μ€ κ°€μ¤‘μΉλ¥Ό λ¶€μ—¬ν•©λ‹λ‹¤.

μ΄ λ‘ μ”μ†λ¥Ό ν•¨κ» κ³ λ ¤ν•μ—¬ μ”μ²­μ„ κ°€μ¥ ν¨μ¨μ μΌλ΅ μ²λ¦¬ν•  μ μλ” μ„λ²„λ¥Ό μ„ νƒν•©λ‹λ‹¤.

μλ¥Ό λ“¤μ–΄ λ‹¤μκ³Ό κ°™μ€ μ„λ²„κ°€ μλ‹¤κ³  κ°€μ •ν•©λ‹λ‹¤.


| μ„λ²„ | κ°€μ¤‘μΉ(Weight) | ν„μ¬ μ—°κ²° μ(Connections) |
|----|-------------|----------------------|
| A  | 3           | 9                    |
| B  | 2           | 4                    |
| C  | 1           | 1                    |

μ΄λ• λ‹¤μ μ”μ²­μ΄ λ“¤μ–΄μ¤λ©΄ β€μ—°κ²° μ Γ· κ°€μ¤‘μΉβ€ κ°’μ΄ κ°€μ¥ μ‘μ€ μ„λ²„μ— ν• λ‹Ήλ©λ‹λ‹¤.
- A μ„λ²„: 9 Γ· 3 = 3
- B μ„λ²„: 4 Γ· 2 = 2
- C μ„λ²„: 1 Γ· 1 = 1

π‘‰π» μ΄ κ²½μ° κ°’μ΄ κ°€μ¥ μ‘μ€ C μ„λ²„κ°€ μ„ νƒλ©λ‹λ‹¤.

### π“ μµμ† μ‘λ‹µ μ‹κ°„(Least Response Time)
κ° μ„λ²„μ μ‘λ‹µ μ‹κ°„μ„ λ¨λ‹ν„°λ§ν•κ³  μλ” κ²½μ°μ— μ‚¬μ©ν•  μ μμµλ‹λ‹¤. μ‘λ‹µ μ‹κ°„μ΄ κ°€μ¥ λΉ λ¥Έ μ„λ²„μ— μ”μ²­μ„ μ „λ‹¬ν•λ” λ°©μ‹μ…λ‹λ‹¤. μ„λ²„λ“¤λ§λ‹¤ μ‘λ‹µ μ‹κ°„μ΄ λ‹¤μ–‘ν•  κ²½μ°, κ°€μ¥ λΉ λ¥Έ μ„λ²„μ— μ”μ²­μ„ μ „λ‹¬ν•μ—¬ μ‚¬μ©μ κ²½ν—μ„ κ°μ„ ν•λ”λ° λ„μ›€μ΄ λ  μ μμµλ‹λ‹¤. μ‘λ‹µ μ‹κ°„μ„ κΈ°λ°μΌλ΅ ν•κΈ° λ•λ¬Έμ— μ„λ²„μ λ¶€ν• μƒνƒ, ν™μ„± μ—°κ²° μμ™€ κ°™μ€ λ‹¤λ¥Έ μ”μ†λ“¤μ„ κ³ λ ¤ν•΄μ•Όν•λ” κ²½μ°μ—λ” μ ν•©ν•μ§€ μ•μ„ μ μμµλ‹λ‹¤.

### π“ IP ν•΄μ‹
ν΄λΌμ΄μ–ΈνΈ μ”μ²­μ IPλ¥Ό κΈ°λ°μΌλ΅ μ”μ²­μ„ μ „λ‹¬ν•©λ‹λ‹¤. IPλ¥Ό μ΄μ©ν•΄ κµ¬ν• ν•΄μ‹κ°’μ„ κΈ°λ°μΌλ΅ μ”μ²­μ„ μ „λ‹¬ν•  μ„λ²„λ¥Ό κ²°μ •ν•©λ‹λ‹¤. IP ν•΄μ‹ λ°©μ‹μ€ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„μ μΉν™”μ„± μ μ§€μ— μ΄μ μ„ λ§μ¶ λ°©μ‹μΌλ΅ ν΄λΌμ΄μ–ΈνΈμ μƒνƒμ— κ΄€λ¦¬μ— μ©μ΄ν•λ‹¤λ” μ¥μ μ΄ μμµλ‹λ‹¤. ν•μ§€λ§, μƒν™©μ— λ”°λΌμ„ λ¶€ν•κ°€ κ· λ“±ν•κ² μ΄λ£¨μ–΄μ§€μ§€ μ•λ”λ‹¤λ” λ‹¨μ μ΄ μ΅΄μ¬ν•©λ‹λ‹¤.

![IP Hash Load Balancing](img/ip-hash-load-balancing.png)

#### μ¥μ 
- νΉμ • IPμ—μ„ μ¤λ” μ”μ²­μ€ ν•­μƒ κ°™μ€ μ„λ²„λ΅ λ³΄λ‚΄μ§€κΈ° λ•λ¬Έμ—, μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ κ°„μ μƒνƒ μ μ§€(μΉν™”μ„±) μ— μ λ¦¬
- λ΅κ·ΈμΈ μƒνƒλ‚ μ„Έμ… κ΄€λ¦¬κ°€ μ©μ΄

#### λ‹¨μ 
- IP μ£Όμ† κΈ°λ°μΌλ΅ μ„λ²„λ¥Ό κ³ μ •μ μΌλ΅ ν• λ‹Ήν•λ‹¤ λ³΄λ©΄ μ„λ²„ λ¶€ν•κ°€ κ³ λ¥΄κ² λ¶„μ‚°λμ§€ μ•μ„ μ μμ.  
  (ν΄λΌμ΄μ–ΈνΈ IPμ— λ”°λΌ νΈλν”½ λ¶„ν¬κ°€ λ‹¤λ¥Ό κ²½μ° μ„λ²„ λ¶€ν•κ°€ κ³ λ¥΄μ§€ μ•κ² λ¨)
- ν΄λΌμ΄μ–ΈνΈ IP μ£Όμ†κ°€ κ³ μ •λμ–΄ μμΌλ―€λ΅, νΈλν”½μ΄ λ§μ€ IPμ μ”μ²­μ΄ νΉμ • μ„λ²„μ—λ§ μ§‘μ¤‘λ  μ μμ